version: 2

models:

  - name: intm_pricing__tariffs
    description: Intermediate model at the tariff grain
    columns:
      - name: pricing_tariffs_id
        description: Primary key for the duration, time and price of the tariff 
        tests:
          - not_null
          - unique
      - name: tariff_id
        description: References tariff_id in intm_date__tariffs and intm_pricing__prices. 
      - name: price
        description: Price associated with the tariff
      - name: duration
        description: Duration for which the price applies 
      - name: applies_from
        description: Start time that the tariff is valid from
      - name: applies_to
        description: Start time that the tariff is valid to
      - name: interval
        description: Unit of time that duration refers to (e.g hours)
      - name: repeat
        description: Indicates if the tariff repeats
      - name: proportional
        description: Indicates if the tariff is proportional
      - name: monthly
        description: Indicates if the tariff applies monthly

  - name: intm_date__tariffs
    description: Intermediate model at the tariff date grain
    columns:
      - name: date_tariffs_id
        description: Primary key for the set of dates and day of the week the tariff is valid for
        tests:
          - not_null
      - name: tariff_id
        description: References tariff_id in intm_pricing__tariffs and intm_pricing__prices. 
      - name: day_of_week
        description: Day of the week that the tariff_id is valid for, where day is represented by an integer ranging from 0 to 6
        tests:
          - accepted_values: 
              values: [0,1,2,3,4,5,6]
              quote: false
      - name: valid_from
        description: Start date that the tariff_id is valid from 
      - name: valid_to
        description: End date that the tariff_id is valid until

  - name: intm_pricing__prices
    description: Intermediate model of prices. 
    columns:
      - name: price_id  
        description: Primary key for the set of rules you can use to calculate the cost of a parking session
        tests:
          - not_null
      - name: tariff_id  
        description: References tariff_id in intm_pricing__tariffs and intm_date__tariffs. 
      - name: location_id
        description: The parking space ID at which the price was set
      - name: pricing_mode
        description: Either AUTOMATED or MANUAL
      - name: created_at
        description: Indicates when the price was created
      - name: deleted_at
        description: |
          Indicates when the price was replaced (null = price still in effect)